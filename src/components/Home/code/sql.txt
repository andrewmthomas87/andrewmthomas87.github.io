<pre class='code'><span class='r'>CREATE OR REPLACE VIEW</span> <span class='b'>highorlow</span><br /><span class='r'>AS</span><br />  <span class='r'>SELECT</span> H<span class='lb'>.</span>teamnumber<span class='lb'>,</span><br />         high<span class='lb'>,</span><br />         low<span class='lb'>,</span><br />         <span class='r'>CASE</span><br />           <span class='r'>WHEN</span> low <span class='r'>IS NULL THEN</span> <span class='o'>1</span><br />           <span class='r'>ELSE</span> high <span class='p'>/</span> <span class='lb'>(</span> high <span class='p'>+</span> low <span class='lb'>)</span><br />         <span class='r'>END</span> percentHigh<br />  <span class='r'>FROM</span>   highshots H<br />         <span class='r'>LEFT JOIN</span> lowshots L<br />                <span class='r'>ON</span> H<span class='lb'>.</span>teamnumber <span class='p'>=</span> L<span class='lb'>.</span>teamnumber<br />  <span class='r'>UNION</span><br />  <span class='r'>SELECT</span> L<span class='lb'>.</span>teamnumber<span class='lb'>,</span><br />         high<span class='lb'>,</span><br />         low<span class='lb'>,</span><br />         <span class='r'>CASE</span><br />           <span class='r'>WHEN</span> high <span class='r'>IS NULL THEN</span> <span class='o'>0</span><br />           <span class='r'>ELSE</span> high <span class='p'>/</span> <span class='lb'>(</span> high <span class='p'>+</span> low <span class='lb'>)</span><br /></pre>
